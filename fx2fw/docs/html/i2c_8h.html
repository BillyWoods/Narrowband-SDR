<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fx2lib: include/i2c.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fx2lib
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">i2c.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="fx2types_8h_source.html">fx2types.h</a>&quot;</code><br />
</div>
<p><a href="i2c_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad0d95d791af60d9e939c13d8adcdbfa3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#ad0d95d791af60d9e939c13d8adcdbfa3">i2c_write</a> (<a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> len1, <a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *addr_buf, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> len2, <a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *data_buf)</td></tr>
<tr class="memdesc:ad0d95d791af60d9e939c13d8adcdbfa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">write data to i2c bus.  <a href="#ad0d95d791af60d9e939c13d8adcdbfa3">More...</a><br /></td></tr>
<tr class="separator:ad0d95d791af60d9e939c13d8adcdbfa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25cda8059378d6165f31d93f59adfa82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#a25cda8059378d6165f31d93f59adfa82">i2c_read</a> (<a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> len, <a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *buf)</td></tr>
<tr class="memdesc:a25cda8059378d6165f31d93f59adfa82"><td class="mdescLeft">&#160;</td><td class="mdescRight">read data on the i2c bus.  <a href="#a25cda8059378d6165f31d93f59adfa82">More...</a><br /></td></tr>
<tr class="separator:a25cda8059378d6165f31d93f59adfa82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adefec7c14e6038242b42db1a761b91dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#adefec7c14e6038242b42db1a761b91dd">eeprom_read</a> (<a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> prom_addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> len, <a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *buf)</td></tr>
<tr class="memdesc:adefec7c14e6038242b42db1a761b91dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">read data from an attached eeprom.  <a href="#adefec7c14e6038242b42db1a761b91dd">More...</a><br /></td></tr>
<tr class="separator:adefec7c14e6038242b42db1a761b91dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bcfca6cb9ce85106e0c1859950c11f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#a33bcfca6cb9ce85106e0c1859950c11f">eeprom_write</a> (<a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> prom_addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> addr, <a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a> len, <a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *buf)</td></tr>
<tr class="memdesc:a33bcfca6cb9ce85106e0c1859950c11f"><td class="mdescLeft">&#160;</td><td class="mdescRight">write data to the eeprom  <a href="#a33bcfca6cb9ce85106e0c1859950c11f">More...</a><br /></td></tr>
<tr class="separator:a33bcfca6cb9ce85106e0c1859950c11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44b48afc5add383f4fe74e93f2d08ea1"><td class="memItemLeft" align="right" valign="top">volatile __xdata <a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#a44b48afc5add383f4fe74e93f2d08ea1">cancel_i2c_trans</a></td></tr>
<tr class="separator:a44b48afc5add383f4fe74e93f2d08ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities for reading and writing to i2c devices and as eeproms. </p>

<p class="definition">Definition in file <a class="el" href="i2c_8h_source.html">i2c.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="adefec7c14e6038242b42db1a761b91dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adefec7c14e6038242b42db1a761b91dd">&#9670;&nbsp;</a></span>eeprom_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a> eeprom_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>prom_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read data from an attached eeprom. </p>
<p>Writes the address of the data to read then reads len bytes into buf. This function checks the I2CS register to determine if a one or two byte address eepom was detected on the i2c bus. Reading from proms at non-standard addresses my require using the i2c_read/write commands explicitly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prom_addr</td><td>eeprom i2c address </td></tr>
    <tr><td class="paramname">addr</td><td>address of bytes to start reading </td></tr>
    <tr><td class="paramname">len</td><td>number of bytes to read </td></tr>
    <tr><td class="paramname">buf</td><td>data buffer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a33bcfca6cb9ce85106e0c1859950c11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33bcfca6cb9ce85106e0c1859950c11f">&#9670;&nbsp;</a></span>eeprom_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a> eeprom_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>prom_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write data to the eeprom </p>
<p>This function checks the I2CS register to determin if a one or two two byte eeprom is detected. If the prom is not detected at boot time or is connected to alternate addresses, the i2c_read/write commands should be used explicitly insread of using this function.</p>
<p>For each byte in buf, the address is written and then the data byte. Many proms support writing multiple bytes at the same time. For these, it is also better to use i2c_read/write explicitly. This function is rather slow but is effective.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prom_addr</td><td>eeprom i2c address </td></tr>
    <tr><td class="paramname">addr</td><td>address of bytes to start writing </td></tr>
    <tr><td class="paramname">len</td><td>number of bytes to write </td></tr>
    <tr><td class="paramname">buf</td><td>data buffer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a25cda8059378d6165f31d93f59adfa82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25cda8059378d6165f31d93f59adfa82">&#9670;&nbsp;</a></span>i2c_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a> i2c_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read data on the i2c bus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>i2c address </td></tr>
    <tr><td class="paramname">len</td><td>number of bytes to read </td></tr>
    <tr><td class="paramname">buf</td><td>buffer to store data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad0d95d791af60d9e939c13d8adcdbfa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0d95d791af60d9e939c13d8adcdbfa3">&#9670;&nbsp;</a></span>i2c_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a> i2c_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>len1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>addr_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#ad2baa11c897721ff6f14b452b547f9bc">WORD</a>&#160;</td>
          <td class="paramname"><em>len2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fx2types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>data_buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write data to i2c bus. </p>
<p>Writes data from addr buffer 1st, then data buffer. Either buffer can be NULL (as long as you set lenN to 0).</p>
<p>Two buffers allows writing data all in one i2c write command without having to write a hardware address and a data byte with each i2c transaction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>i2c address </td></tr>
    <tr><td class="paramname">len1</td><td>length of addr data </td></tr>
    <tr><td class="paramname">addr_buf</td><td>addr data </td></tr>
    <tr><td class="paramname">len2</td><td>length of data </td></tr>
    <tr><td class="paramname">data_buf</td><td>data bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a44b48afc5add383f4fe74e93f2d08ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44b48afc5add383f4fe74e93f2d08ea1">&#9670;&nbsp;</a></span>cancel_i2c_trans</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile __xdata <a class="el" href="fx2types_8h.html#a67bb6a3d7ee6a2a5950ce437abbe31c8">BOOL</a> cancel_i2c_trans</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>i2c_write and i2c_read set this to FALSE at the beginning of a transaction. If for some reason, the read/write is taking too long or not returning, firmware can set this to TRUE to cause the routine to abort. (Usually done via an interrupt). </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
